# Getting and Cleaning Data: Course Project
## Overview
This is a submission for the last programming assignment for the Coursera course "Getting and Cleaning Data". The files in this repository are:
- README.md         This file
- run_analysis.R    An R file containing the function to run to generate the files specified in the assignment.
- read_dataset.R    An R file for the read_dataset function, which reads either the train or test dataset. Used by run_analysis.R.
- rename_features.R A R file for the rename_features function, which creates more legible names out of the orioginal column names. Used by run_analysis.R.
- CodeBook.md       A code book explaining the contents of the generated files
The following files are generated by the run_analysis function:
- dataset.csv       The filtered and cleaned-up dataset, as requested in the assignment
- averages.csv      The averages grouped by Subject and Activity, as requested in the assignment
- UCI HAR Dataset   A directory containing the UCI HAR Dataset. 

## Usage
The run_analysis() function, called without arguments, will:
- Check for the existence of the "UCI HAR Dataset" directory. If it does not exist, the UCI HAR Dataset will be downloaded (the URL is hardcoded in run_analysis.R), and extracted to that directory.
- Both the Training and Test datasets will be read and merged, whereas only the columns containing "measurements on the mean and standard deviation for each measurement" are kept (see below for the interpretation used for this requirement). 
- The Column names in the resulting dataset are renamed to more legible names
- Averages for each value are calculated for each activity and subject
- The merged dataset and the calculated averages are saved to a text file as instructed in the submission page

## Implementation notes
Each R file contains an large number of comments. Some of the more important implementation details are explained here additionally. 

### Downloading the datasets 
The run_analysis() function expects the dataset to be present in the working directory under a subdirectory called "UCI HAR Dataset". If it does not exist, the UCI HAR Dataset will be downloaded (the URL is hardcoded in run_analysis.R), and extracted to that directory. 
To force the script to re-download and overwrite the current dataset, specify downloadDataset=TRUE when calling run_analysis.

### Reading the datasets 
The run_analysis() function relies on read_dataset() to read a single dataset, specifying either "train" or "test" as the dataset to read. read_dataset() then returns the entire dataset, including the Activity and Subject columns.  This implies merginc columns read from 3 different files.
run_analysis() passess 4 variables to read_dataset():
- rootDir, the root directory of the Dataset ("UCI HAR Dataset", as is in the dataset ZIP file)
- setName, the name of the dataset to read (either "train" or "test", corresponding to the structure in the Dataset zip file)
- featureNames, the name of the deatures in the dataset
- keepFeature, containing one logical value per feature that specifies whether that feature (column) should be returned. If false, the corresponding column will be filtered out.

### Renaming the columns 
To change the column names to more legible labels, run_analysis() calls the rename_features() function, passing the column names that remain in the results after filtering. The rename_features() function returns a list of the same length containing the new names. These names are generated using a number of regular expressions executed using gsub. This is an attempt to design a solution that is generic, and will still rename most of the columns if the column selection criteria changes.

### Filtering the columns 
The assignment specifies that only "measurements on the mean and standard deviation for each measurement" are to be kept. I interpret "measurement" as meaning data that is directly measured as opposed to being derived from measured data. This means filtering out 
- the calculated magnitude data
- the calculated jerk data
- all frequency data, which has been calculated by applying a Fast Fourrier Transformation on the measured data

Using a regular expression, run_analysis() chooses which columns to keep by applying the following logic:
- field name beginning with t (time-domain, as opposed to Frequency data)
- fields not containing "Mag" or "Jerk" (since the Magnitudes and Jerk signals are derived from the measurements)
- field name containing "mean()" or "std()" (so only the means and standard deviations)
